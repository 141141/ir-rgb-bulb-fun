#include <IRremote.h>
#include <stdarg.h>
#include <stdio.h>

const int ARRAY_SIZE = 67;
const int KHZ = 38; // 38KHz carrier frequency

String serialData;
boolean sendData;

IRsend irsend;

void setup() {
  Serial.begin(9600);
  while (! Serial);
}

void loop() {
  if (Serial.available()) {
    serialData = Serial.readString();

    // Make sure to send data with the "No line ending" option
    if (serialData.length() > 0) {
      unsigned int rawData[ARRAY_SIZE];
      sendData = true;

      if (serialData == "N") { // ON
        fillArray(rawData, 8950, 4550, 450, 650, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 500, 600, 500, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 1750, 550, 1650, 500, 1750, 450, 1750, 550);
      } else if (serialData == "F") { // OFF
        fillArray(rawData, 8900, 4600, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 1750, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 1750, 500, 1750, 450, 1750, 450, 700, 450, 1750, 500, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "+") { // DIM UP
        fillArray(rawData, 8950, 4550, 500, 650, 450, 650, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 450, 1750, 500, 650, 450, 650, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 450, 1750, 500);
      } else if (serialData == "-") { // DIM DOWN
        fillArray(rawData, 8900, 4600, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 1750, 450, 1750, 450, 1750, 500, 1750, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 700, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 1800, 450, 1750, 450, 1750, 500, 1750, 450, 1750, 500, 1700, 500, 1750, 500);
      } else if (serialData == "R") { // RED
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 700, 450, 1750, 450, 700, 450, 650, 450, 700, 450, 650, 500, 650, 450, 1750, 450, 1800, 450, 650, 500, 1750, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "O") { // ORANGE
        fillArray(rawData, 8900, 4600, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 700, 450, 650, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450);
      } else if (serialData == "Y") { // YELLOW
        fillArray(rawData, 8900, 4600, 450, 700, 450, 600, 500, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 700, 450, 650, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450);
      } else if (serialData == "H") { // CHARTREUSE
        fillArray(rawData, 8950, 4550, 500, 600, 500, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 450, 1750, 500, 650, 500, 650, 450, 650, 500, 600, 500, 1750, 500, 600, 500, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 500, 1750, 450, 700, 450, 1750, 450, 1750, 500, 1750, 450);
      } else if (serialData == "G") { // GREEN
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 1750, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 1750, 450, 650, 500, 1750, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "T") { // TURQUOISE
        fillArray(rawData, 8900, 4550, 500, 650, 450, 650, 500, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 650, 450, 1800, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 500, 1750, 450, 1750, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "C") { // CADET BLUE
        fillArray(rawData, 8900, 4550, 500, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 700, 450, 1750, 450, 1800, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 1800, 450, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "A") { // AQUA
        fillArray(rawData, 8900, 4550, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1700, 500, 1750, 500, 600, 500, 650, 500, 650, 450, 1750, 500, 650, 450, 650, 500, 650, 450, 650, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1750, 450);
      } else if (serialData == "B") { // BLUE
        fillArray(rawData, 8900, 4550, 500, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 1750, 500, 650, 450, 650, 500, 1750, 450, 1750, 500, 1750, 450, 1750, 500, 1700, 500);
      } else if (serialData == "I") { // INDIGO
        fillArray(rawData, 8950, 4550, 500, 600, 500, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 1750, 450, 1750, 500, 1750, 450, 1750, 500, 650, 450, 1750, 500, 1700, 500, 1750, 500, 600, 500, 1750, 500, 600, 500, 1750, 500, 600, 500, 650, 500, 600, 500, 650, 500, 1700, 500, 650, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 500);
      } else if (serialData == "V") { // VIOLET
        fillArray(rawData, 8900, 4550, 500, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 500, 1700, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1750, 500, 600, 500, 650, 500, 600, 500, 650, 500, 1700, 500, 650, 500, 600, 550, 600, 500, 1700, 550, 1700, 500, 1700, 500, 1750, 500);
      } else if (serialData == "P") { // PINK
        fillArray(rawData, 8950, 4550, 500, 600, 500, 650, 500, 600, 550, 600, 500, 600, 550, 600, 500, 600, 500, 650, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 650, 500, 600, 550, 1700, 500, 600, 500, 650, 500, 600, 550, 1700, 500, 650, 500, 1700, 500, 1750, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500);
      } else if (serialData == "W") { // WHITE
        fillArray(rawData, 8900, 4550, 450, 700, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 700, 450, 1750, 450, 1750, 500, 1750, 450, 1750, 500, 600, 500, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 700, 450, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450);
      } else if (serialData == "L") { // FLASH
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1750, 500, 1750, 450, 1750, 450, 700, 450, 1750, 450, 700, 450, 650, 500, 650, 450, 650, 500, 650, 450, 700, 450, 1750, 450, 700, 450, 1750, 450, 1750, 500, 1750, 450, 1750, 450);
      } else if (serialData == "S") { // STROBE
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 500, 650, 450, 650, 500, 650, 450, 700, 450, 650, 450, 1800, 450, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "Z") { // FADE
        fillArray(rawData, 8900, 4600, 450, 650, 500, 600, 500, 650, 500, 600, 500, 650, 500, 650, 450, 650, 500, 650, 450, 1750, 500, 1750, 450, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 600, 500, 1750, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500);
      } else if (serialData == "<") { // PREV SONG
        fillArray(rawData, 8900, 4600, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 450, 650, 500, 650, 500, 1700, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 1750, 500, 1700, 500, 650, 500, 650, 450, 1750, 500, 650, 450, 1750, 500, 650, 450, 650, 500, 650, 450, 1750, 500, 1700, 500, 650, 500, 1700, 500, 650, 500, 1700, 500, 1750, 500, 1700, 500);
      } else if (serialData == ">") { // NEXT SONG
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 700, 450, 1750, 450, 1800, 400, 1800, 450, 1800, 400, 700, 450, 1800, 400, 1800, 450, 1800, 400, 700, 450, 1800, 400, 1800, 450, 700, 400, 1800, 450, 700, 400, 700, 450, 700, 450, 1750, 450, 700, 450, 650, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450);
      } else if (serialData == "E") { // PLAY/PAUSE
        fillArray(rawData, 8900, 4550, 500, 650, 500, 600, 600, 550, 500, 600, 500, 650, 500, 600, 500, 650, 500, 600, 500, 1750, 500, 1700, 500, 1750, 500, 1700, 500, 650, 500, 1700, 500, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 650, 500, 1750, 450, 650, 500, 650, 450, 650, 500, 650, 450, 1750, 500, 650, 450, 1750, 500, 650, 550, 1650, 500, 1750, 450, 1750, 500);
      } else if (serialData == "K") { // FLICKER
        fillArray(rawData, 8900, 4600, 450, 650, 450, 700, 450, 650, 450, 700, 450, 650, 450, 650, 500, 650, 450, 700, 450, 1750, 450, 1800, 450, 1750, 450, 1800, 450, 650, 450, 1800, 450, 1750, 450, 1800, 450, 1750, 450, 1750, 500, 1750, 450, 650, 500, 1750, 450, 650, 500, 650, 450, 650, 500, 650, 450, 700, 450, 650, 450, 1800, 450, 650, 450, 1750, 500, 1750, 450, 1750, 500);
      } else {
        sendData = false;
      }

      if (sendData) {
        irsend.sendRaw(rawData, sizeof(rawData) / sizeof(rawData[0]), KHZ);
      }
    }

    delay(1000); //1 second delay between each signal burst
  }
}

void fillArray(unsigned int rawData[], ...) {
  va_list args;
  va_start (args, rawData);  // Requires the last fixed parameter (to get the address)
  for (int x = 0; x < ARRAY_SIZE; x++) {
    rawData[x] = va_arg(args, unsigned int); // Requires the type to cast to. Increments ap to the next argument
  }
  va_end(args);
}
